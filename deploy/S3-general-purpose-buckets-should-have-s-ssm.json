{
  "schemaVersion": "2.2",
  "description": "Auto-remediation for S3-general-purpose-buckets-should-have-server-acce",
  "parameters": {
    "BucketName": {
      "type": "String",
      "description": "Name of the S3 bucket to remediate",
      "default": ""
    },
    "LogBucketName": {
      "type": "String",
      "description": "Name of the S3 bucket to store access logs",
      "default": ""
    },
    "LogFilePrefix": {
      "type": "String",
      "description": "Prefix for the log files",
      "default": "access-logs/"
    }
  },
  "mainSteps": [
    {
      "name": "enableServerAccessLogging",
      "action": "aws:executeAwsApi",
      "inputs": {
        "Service": "s3",
        "Api": "PutBucketLogging",
        "BucketName": "{{BucketName}}",
        "BucketLoggingStatus": {
          "LoggingEnabled": {
            "TargetBucket": "{{LogBucketName}}",
            "TargetPrefix": "{{LogFilePrefix}}"
          }
        }
      }
    }
  ]
}